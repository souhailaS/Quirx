{
  "timestamp": "2025-07-24T00:19:27.249589",
  "prompt_file": "examples/prompt_sql.txt",
  "input_text": "Show me all users who registered in the last 30 days and have made at least one purchase",
  "model": "gpt-4o-mini",
  "total_mutations": 6,
  "results": [
    {
      "mutation": {
        "original_text": "You are a SQL expert. Generate a valid SQL query for the given request.\n\nRules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase",
        "mutated_text": "You are a SQL expert Generate a valid SQL query for the given request\n\nRules\n Use proper SQL syntax\n Return only the SQL query without explanations\n Use appropriate table and column names\n Ensure the query is syntactically correct\n\nRequest\n\nShow me all users who registered in the last 30 days and have made at least one purchase",
        "mutation_type": "lexical",
        "description": "Remove all punctuation",
        "severity": 0.4
      },
      "original_response": {
        "text": "```sql\nSELECT u.*\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL '30 days'\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) >= 1;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 133,
        "response_time": 2.532717227935791,
        "error": null
      },
      "mutated_response": {
        "text": "```sql\nSELECT u.*\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL '30 days'\nGROUP BY u.user_id;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 117,
        "response_time": 1.279284954071045,
        "error": null
      },
      "comparison": {
        "token_similarity": 0.8974358974358975,
        "semantic_similarity": 0.9590997695922852,
        "structural_similarity": 1.0,
        "overall_similarity": 0.9487806540269117,
        "classification": "minor_variation",
        "details": {
          "character_diff": [
            "--- original\n",
            "+++ mutated\n",
            "@@ -3,6 +3,5 @@\n",
            " FROM users u\n",
            " JOIN purchases p ON u.user_id = p.user_id\n",
            " WHERE u.registration_date >= NOW() - INTERVAL '30 days'\n",
            "-GROUP BY u.user_id\n",
            "-HAVING COUNT(p.purchase_id) >= 1;\n",
            "+GROUP BY u.user_id;\n",
            " ```"
          ],
          "word_diff": {
            "added": [
              "u.user_id;"
            ],
            "removed": [
              "u.user_id",
              "HAVING",
              "COUNT(p.purchase_id)",
              ">=",
              "1;"
            ]
          },
          "length_ratio": 0.8216216216216217,
          "is_json_valid": {
            "original_valid": false,
            "mutated_valid": false
          },
          "bleu_score": 0.7586044552100755
        }
      }
    },
    {
      "mutation": {
        "original_text": "You are a SQL expert. Generate a valid SQL query for the given request.\n\nRules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase",
        "mutated_text": "YOU ARE A SQL EXPERT. GENERATE A VALID SQL QUERY FOR THE GIVEN REQUEST.\n\nRULES:\n- USE PROPER SQL SYNTAX\n- RETURN ONLY THE SQL QUERY WITHOUT EXPLANATIONS\n- USE APPROPRIATE TABLE AND COLUMN NAMES\n- ENSURE THE QUERY IS SYNTACTICALLY CORRECT\n\nREQUEST:\n\nSHOW ME ALL USERS WHO REGISTERED IN THE LAST 30 DAYS AND HAVE MADE AT LEAST ONE PURCHASE",
        "mutation_type": "lexical",
        "description": "Convert all text to uppercase",
        "severity": 0.1
      },
      "original_response": {
        "text": "```sql\nSELECT u.*\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL '30 days'\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) >= 1;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 133,
        "response_time": 2.532717227935791,
        "error": null
      },
      "mutated_response": {
        "text": "```sql\nSELECT u.user_id, u.username, u.registration_date\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL 30 DAY\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) > 0;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 158,
        "response_time": 1.3825020790100098,
        "error": null
      },
      "comparison": {
        "token_similarity": 0.813953488372093,
        "semantic_similarity": 0.9783420562744141,
        "structural_similarity": 0.625,
        "overall_similarity": 0.8583570746488349,
        "classification": "minor_variation",
        "details": {
          "character_diff": [
            "--- original\n",
            "+++ mutated\n",
            "@@ -1,8 +1,8 @@\n",
            " ```sql\n",
            "-SELECT u.*\n",
            "+SELECT u.user_id, u.username, u.registration_date\n",
            " FROM users u\n",
            " JOIN purchases p ON u.user_id = p.user_id\n",
            "-WHERE u.registration_date >= NOW() - INTERVAL '30 days'\n",
            "+WHERE u.registration_date >= NOW() - INTERVAL 30 DAY\n",
            " GROUP BY u.user_id\n",
            "-HAVING COUNT(p.purchase_id) >= 1;\n",
            "+HAVING COUNT(p.purchase_id) > 0;\n",
            " ```"
          ],
          "word_diff": {
            "added": [
              "u.user_id,",
              "u.username,",
              "u.registration_date",
              "30",
              "DAY",
              ">",
              "0;"
            ],
            "removed": [
              "u.*",
              "'30",
              "days'",
              ">=",
              "1;"
            ]
          },
          "length_ratio": 1.1891891891891893,
          "is_json_valid": {
            "original_valid": false,
            "mutated_valid": false
          },
          "bleu_score": 0.6906212482273345
        }
      }
    },
    {
      "mutation": {
        "original_text": "You are a SQL expert. Generate a valid SQL query for the given request.\n\nRules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase",
        "mutated_text": "Generate a valid SQL query for the given request. Rules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase You are a SQL expert.",
        "mutation_type": "structural",
        "description": "Randomly reorder sentences",
        "severity": 0.6
      },
      "original_response": {
        "text": "```sql\nSELECT u.*\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL '30 days'\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) >= 1;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 133,
        "response_time": 2.532717227935791,
        "error": null
      },
      "mutated_response": {
        "text": "```sql\nSELECT u.*\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL '30 days'\nGROUP BY u.user_id;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 122,
        "response_time": 1.1457760334014893,
        "error": null
      },
      "comparison": {
        "token_similarity": 0.8974358974358975,
        "semantic_similarity": 0.9590997695922852,
        "structural_similarity": 1.0,
        "overall_similarity": 0.9487806540269117,
        "classification": "minor_variation",
        "details": {
          "character_diff": [
            "--- original\n",
            "+++ mutated\n",
            "@@ -3,6 +3,5 @@\n",
            " FROM users u\n",
            " JOIN purchases p ON u.user_id = p.user_id\n",
            " WHERE u.registration_date >= NOW() - INTERVAL '30 days'\n",
            "-GROUP BY u.user_id\n",
            "-HAVING COUNT(p.purchase_id) >= 1;\n",
            "+GROUP BY u.user_id;\n",
            " ```"
          ],
          "word_diff": {
            "added": [
              "u.user_id;"
            ],
            "removed": [
              "u.user_id",
              "HAVING",
              "COUNT(p.purchase_id)",
              ">=",
              "1;"
            ]
          },
          "length_ratio": 0.8216216216216217,
          "is_json_valid": {
            "original_valid": false,
            "mutated_valid": false
          },
          "bleu_score": 0.7586044552100755
        }
      }
    },
    {
      "mutation": {
        "original_text": "You are a SQL expert. Generate a valid SQL query for the given request.\n\nRules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase",
        "mutated_text": "Generate a valid SQL query for the given request. You are a SQL expert. Rules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase",
        "mutation_type": "structural",
        "description": "Randomly reorder sentences",
        "severity": 0.6
      },
      "original_response": {
        "text": "```sql\nSELECT u.*\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL '30 days'\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) >= 1;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 133,
        "response_time": 2.532717227935791,
        "error": null
      },
      "mutated_response": {
        "text": "```sql\nSELECT u.user_id, u.username, u.registration_date\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL 30 DAY\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) > 0;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 142,
        "response_time": 1.731623888015747,
        "error": null
      },
      "comparison": {
        "token_similarity": 0.813953488372093,
        "semantic_similarity": 0.9783420562744141,
        "structural_similarity": 0.625,
        "overall_similarity": 0.8583570746488349,
        "classification": "minor_variation",
        "details": {
          "character_diff": [
            "--- original\n",
            "+++ mutated\n",
            "@@ -1,8 +1,8 @@\n",
            " ```sql\n",
            "-SELECT u.*\n",
            "+SELECT u.user_id, u.username, u.registration_date\n",
            " FROM users u\n",
            " JOIN purchases p ON u.user_id = p.user_id\n",
            "-WHERE u.registration_date >= NOW() - INTERVAL '30 days'\n",
            "+WHERE u.registration_date >= NOW() - INTERVAL 30 DAY\n",
            " GROUP BY u.user_id\n",
            "-HAVING COUNT(p.purchase_id) >= 1;\n",
            "+HAVING COUNT(p.purchase_id) > 0;\n",
            " ```"
          ],
          "word_diff": {
            "added": [
              "u.user_id,",
              "u.username,",
              "u.registration_date",
              "30",
              "DAY",
              ">",
              "0;"
            ],
            "removed": [
              "u.*",
              "'30",
              "days'",
              ">=",
              "1;"
            ]
          },
          "length_ratio": 1.1891891891891893,
          "is_json_valid": {
            "original_valid": false,
            "mutated_valid": false
          },
          "bleu_score": 0.6906212482273345
        }
      }
    },
    {
      "mutation": {
        "original_text": "You are a SQL expert. Generate a valid SQL query for the given request.\n\nRules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase",
        "mutated_text": "Rules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase Generate a valid SQL query for the given request. You are a SQL expert.",
        "mutation_type": "structural",
        "description": "Reverse sentence order",
        "severity": 0.5
      },
      "original_response": {
        "text": "```sql\nSELECT u.*\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL '30 days'\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) >= 1;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 133,
        "response_time": 2.532717227935791,
        "error": null
      },
      "mutated_response": {
        "text": "```sql\nSELECT u.*\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= CURRENT_DATE - INTERVAL '30 days'\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) >= 1;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 133,
        "response_time": 1.7820861339569092,
        "error": null
      },
      "comparison": {
        "token_similarity": 0.9523809523809523,
        "semantic_similarity": 0.9924889802932739,
        "structural_similarity": 0.875,
        "overall_similarity": 0.9569587758609227,
        "classification": "equivalent",
        "details": {
          "character_diff": [
            "--- original\n",
            "+++ mutated\n",
            "@@ -2,7 +2,7 @@\n",
            " SELECT u.*\n",
            " FROM users u\n",
            " JOIN purchases p ON u.user_id = p.user_id\n",
            "-WHERE u.registration_date >= NOW() - INTERVAL '30 days'\n",
            "+WHERE u.registration_date >= CURRENT_DATE - INTERVAL '30 days'\n",
            " GROUP BY u.user_id\n",
            " HAVING COUNT(p.purchase_id) >= 1;\n",
            " ```"
          ],
          "word_diff": {
            "added": [
              "CURRENT_DATE"
            ],
            "removed": [
              "NOW()"
            ]
          },
          "length_ratio": 1.037837837837838,
          "is_json_valid": {
            "original_valid": false,
            "mutated_valid": false
          },
          "bleu_score": 0.8908367848788901
        }
      }
    },
    {
      "mutation": {
        "original_text": "You are a SQL expert. Generate a valid SQL query for the given request.\n\nRules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase",
        "mutated_text": "Generate a valid SQL query for the given request. Rules:\n- Use proper SQL syntax\n- Return only the SQL query without explanations\n- Use appropriate table and column names\n- Ensure the query is syntactically correct\n\nRequest:\n\nShow me all users who registered in the last 30 days and have made at least one purchase You are a SQL expert.",
        "mutation_type": "structural",
        "description": "Randomly reorder sentences",
        "severity": 0.6
      },
      "original_response": {
        "text": "```sql\nSELECT u.*\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL '30 days'\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) >= 1;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 133,
        "response_time": 2.532717227935791,
        "error": null
      },
      "mutated_response": {
        "text": "```sql\nSELECT u.user_id, u.username, u.registration_date\nFROM users u\nJOIN purchases p ON u.user_id = p.user_id\nWHERE u.registration_date >= NOW() - INTERVAL 30 DAY\nGROUP BY u.user_id\nHAVING COUNT(p.purchase_id) >= 1;\n```",
        "model": "gpt-4o-mini",
        "tokens_used": 142,
        "response_time": 1.4751129150390625,
        "error": null
      },
      "comparison": {
        "token_similarity": 0.8505747126436781,
        "semantic_similarity": 0.9882888793945312,
        "structural_similarity": 0.625,
        "overall_similarity": 0.874316853490369,
        "classification": "minor_variation",
        "details": {
          "character_diff": [
            "--- original\n",
            "+++ mutated\n",
            "@@ -1,8 +1,8 @@\n",
            " ```sql\n",
            "-SELECT u.*\n",
            "+SELECT u.user_id, u.username, u.registration_date\n",
            " FROM users u\n",
            " JOIN purchases p ON u.user_id = p.user_id\n",
            "-WHERE u.registration_date >= NOW() - INTERVAL '30 days'\n",
            "+WHERE u.registration_date >= NOW() - INTERVAL 30 DAY\n",
            " GROUP BY u.user_id\n",
            " HAVING COUNT(p.purchase_id) >= 1;\n",
            " ```"
          ],
          "word_diff": {
            "added": [
              "u.user_id,",
              "u.username,",
              "u.registration_date",
              "30",
              "DAY"
            ],
            "removed": [
              "u.*",
              "'30",
              "days'"
            ]
          },
          "length_ratio": 1.1945945945945946,
          "is_json_valid": {
            "original_valid": false,
            "mutated_valid": false
          },
          "bleu_score": 0.7608718587327973
        }
      }
    }
  ],
  "summary": {
    "robustness_score": 0.75,
    "equivalent_count": 1,
    "minor_variation_count": 5,
    "behavioral_deviation_count": 0,
    "equivalent_percentage": 16.666666666666664,
    "minor_variation_percentage": 83.33333333333334,
    "behavioral_deviation_percentage": 0.0,
    "avg_response_time": 1.9993907809257507,
    "failed_mutations": 0,
    "total_mutations": 6
  }
}